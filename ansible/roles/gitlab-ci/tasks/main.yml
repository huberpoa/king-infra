--- 
- name: Start GitLab Runner
  become: true
  docker_container:
     name: gitlab-runner
     image: "gitlab/gitlab-runner:latest"
     state: started
     restart_policy: "always"
     volumes:
        - "/srv/gitlab-runner/config:/etc/gitlab-runner"
        - "/etc/docker:/etc/docker"
        - "/var/run/docker.sock:/var/run/docker.sock"

- name: Copy config.toml Runner 
  template:
     src: ./templates/config.j2
     dest: /srv/gitlab-runner/config/config.toml

- name: Install Module pyapi-gitlab
  become: true
  pip:
    name: pyapi-gitlab
    state: latest


#- name: Create Repository In GitLab
#  gitlab_project:
#     server_url: "{{ DOMAIN_GITLAB }}"
#     login_token: "{{ TOKEN_API_GITLAB }}"
#     name: king-infra
#     group: infra
#     state: present
